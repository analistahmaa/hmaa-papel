{"ast":null,"code":"// frontend/src/context/AuthContext.js\nimport React,{createContext,useState,useContext,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const navigate=useNavigate();// Ao carregar a aplicação, tenta buscar o usuário do localStorage\nuseEffect(()=>{const storedUser=localStorage.getItem('usuario');if(storedUser){setUser(JSON.parse(storedUser));}},[]);const login=async userData=>{try{const response=await axios.post('/api/auth/login',userData);const loggedInUser=response.data.usuario;localStorage.setItem('usuario',JSON.stringify(loggedInUser));localStorage.setItem('token',response.data.token);setUser(loggedInUser);navigate('/');window.location.reload();// Força o reload para o App.jsx reavaliar o login\n}catch(error){// Propaga o erro para o formulário de login poder exibi-lo\nthrow error;}};const logout=()=>{localStorage.removeItem('usuario');localStorage.removeItem('token');setUser(null);navigate('/login');window.location.reload();};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,logout},children:children});};// Hook customizado para facilitar o uso do contexto\nexport const useAuth=()=>{return useContext(AuthContext);};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useNavigate","axios","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","navigate","storedUser","localStorage","getItem","JSON","parse","login","userData","response","post","loggedInUser","data","usuario","setItem","stringify","token","window","location","reload","error","logout","removeItem","Provider","value","useAuth"],"sources":["C:/Users/daniel.adm/Documents/PROJETO CONTROLE PAPEL/hmaa-papel/frontend/src/context/AuthContext.js"],"sourcesContent":["// frontend/src/context/AuthContext.js\r\n\r\nimport React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // Ao carregar a aplicação, tenta buscar o usuário do localStorage\r\n  useEffect(() => {\r\n    const storedUser = localStorage.getItem('usuario');\r\n    if (storedUser) {\r\n      setUser(JSON.parse(storedUser));\r\n    }\r\n  }, []);\r\n\r\n  const login = async (userData) => {\r\n    try {\r\n      const response = await axios.post('/api/auth/login', userData);\r\n      const loggedInUser = response.data.usuario;\r\n      localStorage.setItem('usuario', JSON.stringify(loggedInUser));\r\n      localStorage.setItem('token', response.data.token);\r\n      setUser(loggedInUser);\r\n      navigate('/');\r\n      window.location.reload(); // Força o reload para o App.jsx reavaliar o login\r\n    } catch (error) {\r\n      // Propaga o erro para o formulário de login poder exibi-lo\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('usuario');\r\n    localStorage.removeItem('token');\r\n    setUser(null);\r\n    navigate('/login');\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, login, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\n// Hook customizado para facilitar o uso do contexto\r\nexport const useAuth = () => {\r\n  return useContext(AuthContext);\r\n};"],"mappings":"AAAA;AAEA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CAC7E,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE1B,KAAM,CAAAC,WAAW,cAAGR,aAAa,CAAC,IAAI,CAAC,CAEvC,MAAO,MAAM,CAAAS,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAAAa,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAE9B;AACAD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAY,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAClD,GAAIF,UAAU,CAAE,CACdF,OAAO,CAACK,IAAI,CAACC,KAAK,CAACJ,UAAU,CAAC,CAAC,CACjC,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAK,KAAK,CAAG,KAAO,CAAAC,QAAQ,EAAK,CAChC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAjB,KAAK,CAACkB,IAAI,CAAC,iBAAiB,CAAEF,QAAQ,CAAC,CAC9D,KAAM,CAAAG,YAAY,CAAGF,QAAQ,CAACG,IAAI,CAACC,OAAO,CAC1CV,YAAY,CAACW,OAAO,CAAC,SAAS,CAAET,IAAI,CAACU,SAAS,CAACJ,YAAY,CAAC,CAAC,CAC7DR,YAAY,CAACW,OAAO,CAAC,OAAO,CAAEL,QAAQ,CAACG,IAAI,CAACI,KAAK,CAAC,CAClDhB,OAAO,CAACW,YAAY,CAAC,CACrBV,QAAQ,CAAC,GAAG,CAAC,CACbgB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAAE;AAC5B,CAAE,MAAOC,KAAK,CAAE,CACd;AACA,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CACnBlB,YAAY,CAACmB,UAAU,CAAC,SAAS,CAAC,CAClCnB,YAAY,CAACmB,UAAU,CAAC,OAAO,CAAC,CAChCtB,OAAO,CAAC,IAAI,CAAC,CACbC,QAAQ,CAAC,QAAQ,CAAC,CAClBgB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAC,CAED,mBACEzB,IAAA,CAACC,WAAW,CAAC4B,QAAQ,EAACC,KAAK,CAAE,CAAEzB,IAAI,CAAEQ,KAAK,CAAEc,MAAO,CAAE,CAAAvB,QAAA,CAClDA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED;AACA,MAAO,MAAM,CAAA2B,OAAO,CAAGA,CAAA,GAAM,CAC3B,MAAO,CAAApC,UAAU,CAACM,WAAW,CAAC,CAChC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}